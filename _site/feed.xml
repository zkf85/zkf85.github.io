<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2018-12-05T18:03:28+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">KFZ’s Playground</title><subtitle>Theme based on &lt;a href=&quot;http://materializecss.com&quot;&gt;Materialize.css&lt;/a&gt; for jekyll sites.
</subtitle><entry><title type="html">How to Open Jupyter Notebook via SSH</title><link href="http://localhost:4000/2018/12/05/open-jupyter-via-ssh" rel="alternate" type="text/html" title="How to Open Jupyter Notebook via SSH" /><published>2018-12-05T17:09:00+08:00</published><updated>2018-12-05T17:09:00+08:00</updated><id>http://localhost:4000/2018/12/05/open-jupyter-via-ssh</id><content type="html" xml:base="http://localhost:4000/2018/12/05/open-jupyter-via-ssh">&lt;blockquote&gt;
  &lt;p&gt;The Objective is clear as described in the title. The case is usually encountered when logged in a remote server for computation but still want to use the jupyter-notebook that you’re familiar with. This article tells how.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;1-on-your-remote-server&quot;&gt;1. On Your Remote Server&lt;/h2&gt;
&lt;p&gt;Open a Jupyter Notebook with no-browser option:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kf@remote-server &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;jupyter notebook &lt;span class=&quot;nt&quot;&gt;--no-browser&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8887
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-on-your-local-computer&quot;&gt;2. On Your Local Computer&lt;/h2&gt;
&lt;p&gt;Start a &lt;del&gt;SSH Tunnel&lt;/del&gt; and connect it to the Jupyter notebook you just started on the server.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kf@local-computer &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; localhost:8888:localhost:8887 kf@remote-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference:&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://techtalktone.wordpress.com/2017/03/28/running-jupyter-notebooks-on-a-remote-server-via-ssh/&quot;&gt;» RUNNING JUPYTER NOTEBOOKS ON A REMOTE SERVER VIA SSH&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Operating System&quot;]" /><category term="ssh" /><category term="jupyter-notebook" /><summary type="html">The Objective is clear as described in the title. The case is usually encountered when logged in a remote server for computation but still want to use the jupyter-notebook that you’re familiar with. This article tells how.</summary></entry><entry><title type="html">How to make Bootable USB from an ISO with Command Line Tools on macOS?</title><link href="http://localhost:4000/2018/12/05/how-to-format-a-usb-on-linux" rel="alternate" type="text/html" title="How to make Bootable USB from an ISO with Command Line Tools on macOS?" /><published>2018-12-05T16:09:00+08:00</published><updated>2018-12-05T16:09:00+08:00</updated><id>http://localhost:4000/2018/12/05/how-to-format-a-usb-on-linux</id><content type="html" xml:base="http://localhost:4000/2018/12/05/how-to-format-a-usb-on-linux">&lt;blockquote&gt;
  &lt;p&gt;Making things happen without any third party tools is joyful. In this article, I’d like to show how to make a bootable USB simply using built-in commands in a terminal on macOS.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/20181205-bootable-usb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;1-prepare-everything-needed&quot;&gt;1. Prepare Everything Needed&lt;/h2&gt;
&lt;p&gt;What you need:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;A Ubuntu installer ISO file, you can download from either site below:&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://www.ubuntu.com/download/alternative-downloads&quot;&gt;» Ubuntu Official Installer Downloads Page&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/&quot;&gt;» Tsinghua Mirrors of Ubuntu Releases (extremely fast for users in China)&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A Flash Drive that is free to use.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;2-clear-up-your-usb-flash-drive-optional&quot;&gt;2. Clear up your USB Flash Drive (Optional)&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://www.theinstructional.com/guides/disk-management-from-the-command-line-part-1&quot;&gt;» Disk Management From the Command-Line, Part 1&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;21-locate-your-usb-disk&quot;&gt;2.1. Locate your USB disk&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;List the partition of the disk:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Then find your usb disk info as below:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  /dev/disk2 (external, physical):
     #:                       TYPE NAME                    SIZE       IDENTIFIER
     0:     Apple_partition_scheme                        *31.0 GB    disk2
     1:        Apple_partition_map                         4.1 KB     disk2s1
     2:                  Apple_HFS                         2.4 MB     disk2s2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;22-erase-the-disk&quot;&gt;2.2. Erase the disk&lt;/h3&gt;
&lt;p&gt;Erasing disks from the command-line can be a dangerous process as there aren’t any warnings or confirmations. One typo could lead to irreversible data loss if there’s no backup to restore from. If you’re not familiar with the command-line, Disk Utility is just as capable.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;To erase an entire disk&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil eraseDisk &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;filesystem&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Name_to_use&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; /dev/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;disk_identifier&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Erasing a whole disk will clear any partitions and create a new, single partition, before formatting it as a volume.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{filesystem}&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;

    &lt;p&gt;You can specify the filesystem to format the partition in by using any that are supported. 
  To find out which filesystems you can use, enter:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil listFilesystems
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;And you may get this:&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  Formattable file systems

  These file system personalities can be used for erasing and partitioning.
  When specifying a personality as a parameter to a verb, case is not considered.
  Certain common aliases (also case-insensitive) are listed below as well.

  -------------------------------------------------------------------------------
  PERSONALITY                     USER VISIBLE NAME
  -------------------------------------------------------------------------------
  APFS                            APFS
    (or) APFSI
  Case-sensitive APFS             APFS (Case-sensitive)
  ExFAT                           ExFAT
  Free Space                      Free Space
    (or) FREE
  MS-DOS                          MS-DOS (FAT)
  MS-DOS FAT12                    MS-DOS (FAT12)
  MS-DOS FAT16                    MS-DOS (FAT16)
  MS-DOS FAT32                    MS-DOS (FAT32)
    (or) FAT32
  HFS+                            Mac OS Extended
  Case-sensitive HFS+             Mac OS Extended (Case-sensitive)
    (or) HFSX
  Case-sensitive Journaled HFS+   Mac OS Extended (Case-sensitive, Journaled)
    (or) JHFSX
  Journaled HFS+                  Mac OS Extended (Journaled)
    (or) JHFS+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{Name_to_use}&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;

    &lt;p&gt;This simply refers to the name of the volume that will be created. In this instance, I’ve just labelled the volume as “Test”.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{disk_identifier}&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;

    &lt;p&gt;Only the primary part of the identifier (i.e. &lt;code class=&quot;highlighter-rouge&quot;&gt;disk1&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;disk2&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;disk3&lt;/code&gt;…) is needed.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;In my case, the actual command I used to erase the USB disk is&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil eraseDisk fat32 KF-USB /dev/disk2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If sucessful, it will show information like this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Started erase on disk2
Unmounting disk
Creating the partition map
Waiting for partitions to activate
Formatting disk2s2 as MS-DOS (FAT32) with name KF-USB
512 bytes per physical sector
/dev/rdisk2s2: 60161312 sectors in 1880041 FAT32 clusters (16384 bytes/cluster)
bps=512 spc=32 res=32 nft=2 mid=0xf8 spt=32 hds=255 hid=411648 drv=0x80 bsec=60190720 bspf=14688 rdcl=2 infs=1 bkbs=6
Mounting disk
Finished erase on disk2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Meanwhile the USB is automatically mounted to you system as well. In my case, it’s mounted at &lt;code class=&quot;highlighter-rouge&quot;&gt;/Volumes/KF-USB&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now use command &lt;code class=&quot;highlighter-rouge&quot;&gt;diskutil list&lt;/code&gt; again to show the disk partition information, you’ll see the new disk’s info:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/dev/disk2 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *31.0 GB    disk2
   1:                        EFI EFI                     209.7 MB   disk2s1
   2:       Microsoft Basic Data KF-USB                  30.8 GB    disk2s2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;3-create-the-bootable--usb&quot;&gt;3. Create the Bootable  USB&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cybrary.it/0p3n/macos-terminal-create-bootable-usb-iso-using-dd/&quot;&gt;» MacOS Terminal: Create a Bootable USB from an ISO Using “dd”&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Assuming our flash drive is stll &lt;code class=&quot;highlighter-rouge&quot;&gt;disk2&lt;/code&gt;, then&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil unmountDisk disk2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;unmountDisk&lt;/code&gt; command unmounts all volumes of the given disk drive but keeps the drive itself visible to the computer (as opposed to the eject option that disconnects it entirely)&lt;/p&gt;

&lt;p&gt;Then, run the following command to create the bootable USB:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dd &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/Users/kyle/Downloads/Linux.iso &lt;span class=&quot;nv&quot;&gt;of&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/disk2 &lt;span class=&quot;nv&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8m
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;“sudo”&lt;/code&gt;&lt;/strong&gt; tells the system to use root level (that is the system’s highest level) privileges to perform the following action.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;“dd”&lt;/code&gt;&lt;/strong&gt; is an extremely basic, but powerful block level copy command built into all Linux and Unix operating systems (MacOS is UNIX based)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;“if”&lt;/code&gt;&lt;/strong&gt; stands for input file (a.k.a the source file or location). In our use-case, this is the .ISO file. In MacOS, if you have a finder window open, you can drag and drop the .iso into the terminal and it will auto-fill this file path.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;“of”&lt;/code&gt;&lt;/strong&gt; stands for “output file” (a.k.a the destination file or location). For us, this is our USB drive, disk2. The specific path for external drives is in “/dev”, hence /dev/disk2&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;“bs”&lt;/code&gt;&lt;/strong&gt; stands for block size. dd copies data in blocks rather than on a file by file basis (this is why it’s so fast) and this command gives you the option to set how big each block is. There is a science to the ideal block size, but I don’t know it. 8m (MegaBytes) has consistently worked well for my uses.&lt;/p&gt;

&lt;p&gt;The command will not show any progress until it’s done, but you can press control+t for status updates. With an average computer, this takes less than 5min to complete.
Once complete:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;diskutil eject disk2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The USB drive can now safely be removed. Assuming that the iso is EFI-compatible, you can reboot your mac to test it.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Operating System&quot;]" /><category term="macOS" /><category term="bash" /><category term="usb-bootable-stick" /><category term="ubuntu" /><summary type="html">Making things happen without any third party tools is joyful. In this article, I’d like to show how to make a bootable USB simply using built-in commands in a terminal on macOS.</summary></entry><entry><title type="html">Deploy Keras Model with Flask+uWSGI+NGINX with docker</title><link href="http://localhost:4000/2018/12/03/flask-uwsgi-nginx-deploy" rel="alternate" type="text/html" title="Deploy Keras Model with Flask+uWSGI+NGINX with docker" /><published>2018-12-03T15:21:00+08:00</published><updated>2018-12-03T15:21:00+08:00</updated><id>http://localhost:4000/2018/12/03/flask-uwsgi-nginx-deploy</id><content type="html" xml:base="http://localhost:4000/2018/12/03/flask-uwsgi-nginx-deploy">&lt;blockquote&gt;
  &lt;p&gt;After spending more than 200 credits on google cloud GPU for training a &lt;strong&gt;Plant Disease Recoginition (PDR)&lt;/strong&gt; model with Keras, I’ve got a decent model that have reached more than 85% accuracy. The model is ready and the next thing to do is to deploy the model for inference as a service.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;1-background&quot;&gt;1. Background&lt;/h2&gt;

&lt;h3 id=&quot;11-objective&quot;&gt;1.1. Objective&lt;/h3&gt;
&lt;p&gt;The main objective is to build a web service API which responds with a inference result as a json file after receiving a request with an image in it.&lt;/p&gt;

&lt;h3 id=&quot;12-what-we-have&quot;&gt;1.2. What we have?&lt;/h3&gt;
&lt;p&gt;At the moment, we have a well-built keras model, trained with &lt;code class=&quot;highlighter-rouge&quot;&gt;keras==2.2.4&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;tensorflow==1.11.0&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;python==3.5.2&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;13-what-strategy-we-choose&quot;&gt;1.3. What strategy we choose?&lt;/h3&gt;
&lt;p&gt;Basically, it’s &lt;strong&gt;“Flask + uWSGI + NGINX”&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://flask.pocoo.org&quot;&gt;Flask&lt;/a&gt; is a good python microframework for web development. It is pretty easy to make an improvised API with Flask. But it’s not recommended to use it to build a formal production.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://uwsgi-docs-additions.readthedocs.io/en/latest/&quot;&gt;uWSGI&lt;/a&gt; aims at developing a full stack for building hosting services. uWSGI is implemented as a linker between Nginx(does not support python) and Flask(written in python).&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.nginx.com/resources/wiki/&quot;&gt;NGINX&lt;/a&gt;  ( &lt;a href=&quot;https://en.wikipedia.org/wiki/Nginx&quot;&gt;/ˌɛndʒɪnˈɛks/ EN-jin-EKS&lt;/a&gt;) is a free, open-source, high-performance HTTP server and reverse proxy.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-deploy-the-flask--uwsgi--nginx-fun-combo-manually&quot;&gt;2. Deploy the &lt;strong&gt;Flask + uWSGI + NGINX&lt;/strong&gt; (FUN) Combo Manually&lt;/h2&gt;

&lt;p&gt;Before everything, there’s a complete tutorial on &lt;code class=&quot;highlighter-rouge&quot;&gt;digitalocean&lt;/code&gt; about this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-serve-flask-applications-with-uswgi-and-nginx-on-ubuntu-18-04&quot;&gt;» &lt;strong&gt;How to serve Flask Application with uWSGI and NGINX on Ubuntu 18.04&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;21-flask&quot;&gt;2.1. Flask&lt;/h3&gt;
&lt;p&gt;Here are the basic steps for setting up Flask:&lt;/p&gt;

&lt;p&gt;In your main python script (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.py&lt;/code&gt;),
Import related tools:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Initialize the Flask application:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setup the app route and method, return the response as JSON file:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/predict'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'POST'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsonify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A complete sample code of &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.py&lt;/code&gt; is listed below:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Filename   :  myproject.py&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Written by :  KF &lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Response&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_img&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_to_array&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Initialize the Flask application&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx_dict&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Basic parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_file_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;disease_224.model&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;label_file_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;labels.npz&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;img_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;224&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;224&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Load Keras model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_file_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Initialize a global graph for Keras/tensorflow&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_default_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Load index-label list (not important here in this article)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_file_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;label_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'class_idx'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;idx_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# route http posts to this method&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/predict'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'POST'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Get the image in the POST request &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;image_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'image'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Load the image for Keras model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;img_np&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img_to_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;255.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;img_np&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Predict&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Start predicting ...'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;proba&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;#proba = [1,2,3,4,5]&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Prediction complete！'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res_idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;proba&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Mapping the result index to label (not important for this article)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;best_prediction_label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Build a response dict to send back to client&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'message'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'image received!'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'best_prediction'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;best_prediction_label&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsonify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# Initialize first no matter if it's main or not ...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;* Loading Keras model and Flask starting server...&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;please wait until server has fully started&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# start the flask app, allow remote connection&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'0.0.0.0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threaded&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;:&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Anytime this main &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.py&lt;/code&gt; script is called, the model loading and parameters loading steps should be put in the &lt;code class=&quot;highlighter-rouge&quot;&gt;init()&lt;/code&gt; in order to avoid running the slow process everytime when predicting.&lt;/li&gt;
    &lt;li&gt;In the initialization, a global &lt;code class=&quot;highlighter-rouge&quot;&gt;graph&lt;/code&gt; for keras/tensorflow is initialized. Without this, there’ll be an error.&lt;/li&gt;
    &lt;li&gt;To change the port (e.g. change to 8000, simply change the last line to &lt;code class=&quot;highlighter-rouge&quot;&gt;app.run(host='0.0.0.0', port='8000')&lt;/code&gt;.&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;Run/Test the API with Flask simply by:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python myproject.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the log is as below, it means the Flask API is working well,&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Loading Keras model and Flask starting server...please &lt;span class=&quot;nb&quot;&gt;wait &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;server has fully started
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Serving Flask app &lt;span class=&quot;s2&quot;&gt;&quot;myproject&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lazy loading&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Environment: production
   WARNING: Do not use the development server &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;a production environment.
   Use a production WSGI server instead.
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Debug mode: off
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Running on http://0.0.0.0:5000/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Press CTRL+C to quit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;22-test-the-api&quot;&gt;2.2. Test the API&lt;/h3&gt;

&lt;p&gt;On another computer, write a &lt;code class=&quot;highlighter-rouge&quot;&gt;POST&lt;/code&gt; request in python using &lt;code class=&quot;highlighter-rouge&quot;&gt;requests&lt;/code&gt; library.
In &lt;code class=&quot;highlighter-rouge&quot;&gt;api_test.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Filename   :  api_test.py&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Written by :  KF &lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;requests&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://192.168.1.235:5000'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#addr = 'http://192.168.1.235'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'predict'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'image'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test_image.JPG'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# send http request with image and receive response&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;requests&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#decode response&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you followed the initial server setup guide, you should have a UFW firewall enabled. To test the application, you need to allow access to port 5000:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ufw allow 5000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Make sure that the ip address and port number is correct. Then it should work.&lt;/p&gt;

&lt;h3 id=&quot;23-uwsgi&quot;&gt;2.3. uWSGI&lt;/h3&gt;
&lt;p&gt;As we can see in the log info of running Flask, it warns that &lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;Do not use the development server in a production environment&quot;&lt;/code&gt;&lt;/strong&gt;, which means that Flask by itself is “OK” for testing in development but &lt;strong&gt;not&lt;/strong&gt; designed for production. Therefore, we need to deploy it in a more professional environment, as it says, &lt;strong&gt;“Use a production WSGI server instead”&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://uwsgi-docs-additions.readthedocs.io/en/latest/&quot;&gt;uWSGI (WSGI - Web Server Gateway Interface)&lt;/a&gt; is used here as a tool for connecting &lt;strong&gt;Flask&lt;/strong&gt; and &lt;strong&gt;NGINX&lt;/strong&gt;.&lt;/p&gt;

&lt;h4 id=&quot;231-create-a-uwsgi-configuration-file&quot;&gt;2.3.1. Create a uWSGI Configuration File&lt;/h4&gt;
&lt;p&gt;Let’s place that file in our project directory and call it &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.ini&lt;/code&gt;, in the file, add the following snippet:&lt;/p&gt;
&lt;div class=&quot;language-ini highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[uwsgi]&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;wsgi:app&lt;/span&gt;

&lt;span class=&quot;py&quot;&gt;processes&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;vacuum&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;die-on-term&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;socket&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/tmp/myproject.sock&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;chmod-socket&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;666&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#master = true
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;master&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;:&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;socket&lt;/code&gt; points to a temporery file generated later when the service is on, pointing it to &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/&lt;/code&gt; and change its permission to 666 make sure there’s not a permission problem.&lt;/li&gt;
    &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;processes&lt;/code&gt; is set to &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt; in my case. If not, my API will be stuck at the prediction step.&lt;/li&gt;
    &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;master&lt;/code&gt; is set to &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;. If not, my API will be stuck at t he prediction step.&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;232-creating-a-systemd-unit-file&quot;&gt;2.3.2. Creating a systemd Unit File&lt;/h4&gt;
&lt;p&gt;Next, let’s create the systemd service unit file. Creating a systemd unit file will allow Ubuntu’s init system to automatically start uWSGI and serve the Flask application whenever the server boots.&lt;/p&gt;

&lt;p&gt;Create a unit file ends with .service (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.service&lt;/code&gt;) within the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/systemd/system&lt;/code&gt; directory with the following snippet:&lt;/p&gt;
&lt;div class=&quot;language-ini highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[Unit]&lt;/span&gt;                                                                                                                
&lt;span class=&quot;py&quot;&gt;Description&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;uWSGI instance to serve myproject&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;After&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;network.target&lt;/span&gt;

&lt;span class=&quot;nn&quot;&gt;[Service]&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;kefeng&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;Group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;www-data&lt;/span&gt;

&lt;span class=&quot;py&quot;&gt;WorkingDirectory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/home/kefeng/PlantDiseaseRecognition/myproject&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;Environment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;PATH=/home/kefeng/anaconda3/bin&quot;&lt;/span&gt;

&lt;span class=&quot;py&quot;&gt;ExecStart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;/usr/local/bin/uwsgi --ini myproject.ini&lt;/span&gt;

&lt;span class=&quot;nn&quot;&gt;[Install]&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;WantedBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;multi-user.target&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can now start the uWSGI service we created and enable it so that it starts at boot:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start myproject
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;myproject
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Check the status:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl status myproject
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output should be like this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;● myproject.service - uWSGI instance to serve myproject
   Loaded: loaded (/etc/systemd/system/myproject.service; disabled; vendor preset: enabled)
   Active: active (running) since Mon 2018-12-03 17:58:25 CST; 1h 7min ago
 Main PID: 3889 (uwsgi)
    Tasks: 13 (limit: 4915)
   CGroup: /system.slice/myproject.service
           └─3889 /usr/local/bin/uwsgi --ini myproject.ini

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;24-configuring-nginx-to-proxy-requests&quot;&gt;2.4. Configuring Nginx to Proxy Requests&lt;/h3&gt;
&lt;p&gt;Our uWSGI application server should now be up and running, waiting for requests on the socket file in the project directory. Let’s configure Nginx to pass web requests to that socket using the &lt;code class=&quot;highlighter-rouge&quot;&gt;uwsgi&lt;/code&gt; protocol.&lt;/p&gt;

&lt;p&gt;Create a new server block configuration file in Nginx’s sites-available directory (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;vi /etc/nginx/sites-available/myproject
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Code in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/sites-available/myproject&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
    listen 80;
    server_name 192.168.1.235;

    location / {
        try_files $uri @app;
    }
    location @app {
        include uwsgi_params;
        uwsgi_pass unix:///tmp/myproject.sock;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To enable the Nginx server block configuration you’ve just created, link the file to the sites-enabled directory:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ln &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /etc/nginx/sites-available/myproject /etc/nginx/sites-enabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With the file in that directory, we can test for syntax errors by typing:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nginx &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If this returns without indicating any issues, restart the Nginx process to read the new configuration:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Adjust the firewall again. We no longer need access through port 5000, so we can remove that rule. We can then allow access to the Nginx server:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ufw delete allow 5000
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ufw allow &lt;span class=&quot;s1&quot;&gt;'Nginx Full'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you encounter any errors, trying checking the following:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo less /var/log/nginx/error.log: checks the Nginx error logs.&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo less /var/log/nginx/access.log: checks the Nginx access logs.&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo journalctl -u nginx: checks the Nginx process logs.&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo journalctl -u myproject: checks your Flask app's uWSGI logs.&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;25-test-the-newly-established-api&quot;&gt;2.5 Test the newly established API&lt;/h3&gt;
&lt;p&gt;Use the same python file created in 2.2, only remove the port number since the nginx api use the default port 80.&lt;/p&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;api_test.py&lt;/code&gt;, make the following change:&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://192.168.1.235'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It should work fine as the same as with Flask alone.&lt;/p&gt;

&lt;h2 id=&quot;3-deploy-flask--uwsgi--nginx-fun-combo-with-docker&quot;&gt;3. Deploy &lt;strong&gt;Flask + uWSGI + NGINX&lt;/strong&gt; (FUN) combo with Docker&lt;/h2&gt;

&lt;p&gt;Using Docker to deploy the service is much easier. You can save most work described above.&lt;/p&gt;

&lt;p&gt;Check out &lt;a href=&quot;https://github.com/tiangolo/uwsgi-nginx-flask-docker&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;tiangolo/uwsgi-nginx-flask-docker&lt;/code&gt;&lt;/a&gt; to find and download a suitable version of &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For Docker basics, see my previous article about Docker.&lt;/p&gt;

&lt;h3 id=&quot;31-build-a-customized-version-of-docker-image&quot;&gt;3.1. Build a customized version of docker image&lt;/h3&gt;
&lt;p&gt;In my case, I use &lt;code class=&quot;highlighter-rouge&quot;&gt;python3.6&lt;/code&gt; version image. Besides, it is good practice to build a customized version of image for yourself since&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Several additional python package need to be installed in the Docker;&lt;/li&gt;
  &lt;li&gt;Some minor modifications are needed for the nginx service;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;First, create a folder with a &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; in it;&lt;/p&gt;

&lt;p&gt;Create a &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt; file for additional python packages to be installed in the Docker image.&lt;/p&gt;

&lt;p&gt;In my &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements.txt&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keras==2.2.4
tensorflow==1.11.0
pillow
numpy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The default nginx body buffer size is too small for a POST request with an image in it. Therefore, you need to modifiy this parameter by copy a &lt;code class=&quot;highlighter-rouge&quot;&gt;.conf&lt;/code&gt; file into the Docker image.&lt;/p&gt;

&lt;p&gt;Create a file &lt;code class=&quot;highlighter-rouge&quot;&gt;kf_upload.conf&lt;/code&gt;, in which add:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;client_body_buffer_size 5m;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, write the &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; as below:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM tiangolo/uwsgi-nginx-flask:python3.6

COPY requirements.txt /
COPY kf_upload.conf /etc/nginx/conf.d/
RUN pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r /requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, in the directory including &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; build a customized version of Docker image by:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker build &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; kf-customized-image &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;Note that the &lt;code class=&quot;highlighter-rouge&quot;&gt;kf-customized-image&lt;/code&gt; is the name of the new image you build. You may change it to anything you like.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;32-create-and-run-a-docker-container-with-the-customized-image&quot;&gt;3.2. Create and run a Docker container with the customized image&lt;/h3&gt;
&lt;p&gt;Create a new folder for deploying you api, in which there’s a &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; and a subfolder named &lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Copy the &lt;code class=&quot;highlighter-rouge&quot;&gt;myproject.py&lt;/code&gt; file mentioned in the previous section into the &lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt; folder, rename it as &lt;code class=&quot;highlighter-rouge&quot;&gt;main.py&lt;/code&gt;. Also remember to copy the files used in the &lt;code class=&quot;highlighter-rouge&quot;&gt;main.py&lt;/code&gt; (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;disease.model&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;labels.npz&lt;/code&gt;) in to &lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt; folder too.&lt;/p&gt;

&lt;p&gt;In the base folder (which inlcudes th &lt;code class=&quot;highlighter-rouge&quot;&gt;app&lt;/code&gt; folder and the &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt;), create a &lt;code class=&quot;highlighter-rouge&quot;&gt;uwsgi.ini&lt;/code&gt; file, add the following code:&lt;/p&gt;
&lt;div class=&quot;language-ini highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;[uwsgi]&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;socket&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/tmp/uwsgi.sock&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;chown-socket&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nginx:nginx&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;chmod-socket&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;664&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;cheaper&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;processes&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;master&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, add the following code into the &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM kf-customized-image
COPY uwsgi.ini /etc/uwsgi/

COPY ./app /app
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Build the final version of image that is ready to use, in the base folder:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker build &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; kf-ready-to-deploy-image &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, everything is ready for deployment. You can check if your image is ready in your Docker by:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker image &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, one last step you need to do is to run the image as a container.&lt;/p&gt;

&lt;p&gt;In any working directory, just run:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 80:80 kf-ready-to-deploy-image
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;Note that the &lt;code class=&quot;highlighter-rouge&quot;&gt;-p&lt;/code&gt; parameter is to map the Docker internal port (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt;) to your actual machine’s port (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt;).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Then the  API should be working fine.&lt;/p&gt;

&lt;p&gt;You may use the same &lt;code class=&quot;highlighter-rouge&quot;&gt;api-test.py&lt;/code&gt; on another computer (in the same internal network) to test if the API works appropriately. Remember to make sure that the testing port is consistent with the one set in your service.&lt;/p&gt;

&lt;h3 id=&quot;33-wrap-it-up-and-deploy-it-anywhere-else&quot;&gt;3.3. Wrap it up and deploy it anywhere else&lt;/h3&gt;
&lt;p&gt;The advantage of using Docker is for its compatibility. As long as Docker is installed on your platform, no matter its Windows, Linux or macOS, you can simply deploy your service by running the image you built.&lt;/p&gt;

&lt;p&gt;There are two ways to scale your self-built image:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Log in your Dockerhub account and publish your image, after which, import your image by enter its unique name:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker login             &lt;span class=&quot;c&quot;&gt;# Log in this CLI session using your Docker credentials&lt;/span&gt;
 &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker tag &amp;lt;image&amp;gt; username/repository:tag  &lt;span class=&quot;c&quot;&gt;# Tag &amp;lt;image&amp;gt; for upload to registry&lt;/span&gt;
 &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker push username/repository:tag            &lt;span class=&quot;c&quot;&gt;# Upload tagged image to registry&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Save the Docker image into a &lt;code class=&quot;highlighter-rouge&quot;&gt;.tar&lt;/code&gt; file. Load the &lt;code class=&quot;highlighter-rouge&quot;&gt;.tar&lt;/code&gt; file on any destination machine.&lt;/p&gt;

    &lt;p&gt;Save the Docker image with (the two commands belows are the same):&lt;/p&gt;
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker save &lt;span class=&quot;nt&quot;&gt;--output&lt;/span&gt; kf-ready-to-deploy-image.tar kf-ready-to-deploy-image
 &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker save &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; kf-ready-to-deploy-image.tar kf-ready-to-deploy-image
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Load the Docker image with (the two commands belows are the same):&lt;/p&gt;
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker save &lt;span class=&quot;nt&quot;&gt;--input&lt;/span&gt; kf-ready-to-deploy-image.tar
 &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker save &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; kf-ready-to-deploy-image.tar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;4-conclusion&quot;&gt;4. Conclusion&lt;/h2&gt;
&lt;p&gt;There’re not a lot of articles on deploying Keras models for production, thus I write this complete instruction on how to deploy Keras model with Flask+uWSGI+NGINX strategy. There are two ways to manage the work: 1) configure everything step by step; 2) apply docker to save your time. Both methods can provide the same production-level API with your well-trained Keras model.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Operating System&quot;, &quot;Deep Learning&quot;]" /><category term="docker" /><category term="flask" /><category term="uwsgi" /><category term="nginx" /><category term="keras" /><category term="tensorflow" /><summary type="html">After spending more than 200 credits on google cloud GPU for training a Plant Disease Recoginition (PDR) model with Keras, I’ve got a decent model that have reached more than 85% accuracy. The model is ready and the next thing to do is to deploy the model for inference as a service.</summary></entry><entry><title type="html">Get Started with THE Docker</title><link href="http://localhost:4000/2018/11/28/docker-debut" rel="alternate" type="text/html" title="Get Started with THE Docker" /><published>2018-11-28T00:00:00+08:00</published><updated>2018-11-28T00:00:00+08:00</updated><id>http://localhost:4000/2018/11/28/docker-debut</id><content type="html" xml:base="http://localhost:4000/2018/11/28/docker-debut">&lt;blockquote&gt;
  &lt;p&gt;The famous “Docker” is &lt;strong&gt;&lt;em&gt;a tool that can package an application and tis dependencies in a virtual container that can run on any Linux server&lt;/em&gt;&lt;/strong&gt;. After getting my keras model, it’s a good chance to try docker to deploy a deep learning model as a API service. In this article, I’d like to write down all the important procedures and details about how to make this service work with docker.”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/20181128-laurel-docker-containers.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;1-check-out-docker&quot;&gt;1. Check out Docker!&lt;/h2&gt;
&lt;p&gt;Of course we can install and configure the “&lt;em&gt;Flask/uWSGI/NGINX (FUN)&lt;/em&gt;” combo step by step, but it’s trivial and with bunch of pitfalls.&lt;/p&gt;

&lt;p&gt;Docker is the perfect choice to make such things much easier!&lt;/p&gt;

&lt;h3 id=&quot;11-basic-idea-of-using-docker&quot;&gt;1.1. Basic idea of using Docker&lt;/h3&gt;
&lt;p&gt;The basic idea of using Docker is to avoid installing and configuring environment by yourself. Instead, you can download a ready-to-use &lt;strong&gt;&lt;em&gt;image&lt;/em&gt;&lt;/strong&gt;, which is carefully configured and saved by other people, and run it as a &lt;strong&gt;&lt;em&gt;container&lt;/em&gt;&lt;/strong&gt;, in which you can focus on you own stuff without worrying about whether the environment trivials at all.&lt;/p&gt;

&lt;h2 id=&quot;2-installuninstall-docker&quot;&gt;2. Install/Uninstall Docker&lt;/h2&gt;
&lt;p&gt;Docker is available in two editions:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Community Edition (CE)&lt;/li&gt;
  &lt;li&gt;Enterprise Edition (EE)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The CE edition is suitable for individual developers and it’s free.&lt;/p&gt;

&lt;p&gt;To get Docker CE for Ubuntu, check the instruction &lt;a href=&quot;https://docs.docker.com/install/linux/docker-ce/ubuntu/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;21-prerequisites&quot;&gt;2.1. Prerequisites&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;Uninstall old versions:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get remove docker docker-engine docker.io
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Update the &lt;code class=&quot;highlighter-rouge&quot;&gt;apt&lt;/code&gt; package index:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Install packages to allow apt to use a repository over HTTPS:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get install &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 apt-transport-https &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 ca-certificates &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 curl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Add Docker’s official GPG key:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://download.docker.com/linux/ubuntu/gpg | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-key add -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Verify that you now have the key with the fingerprint &lt;code class=&quot;highlighter-rouge&quot;&gt;9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88&lt;/code&gt;, by searching for the last 8 characters of the fingerprint.&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-key fingerprint 0EBFCD88

 pub   4096R/0EBFCD88 2017-02-22
       Key fingerprint &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
 uid                  Docker Release &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CE deb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;lt;docker@docker.com&amp;gt;
 sub   4096R/F273FCD8 2017-02-22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Use the following command to set up the stable repository. ( For x86_64/amd64)
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;add-apt-repository &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;lsb_release &lt;span class=&quot;nt&quot;&gt;-cs&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
    stable&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;22-install-docker-ce-using-repository&quot;&gt;2.2. Install Docker CE (using repository)&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Update the &lt;code class=&quot;highlighter-rouge&quot;&gt;apt&lt;/code&gt; package index:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Install packages to allow apt to use a repository over HTTPS:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get install &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
     apt-transport-https &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
     ca-certificates &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
     curl &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
     software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Install the &lt;em&gt;latest&lt;/em&gt; version of Docker CE, or go to the next step to install a specific version:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get install docker-ce
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Verify that Docker CE is installed correctly by running the hello-world image.&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;docker run hello-world
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;23-uninstall-docker-ce&quot;&gt;2.3. Uninstall Docker CE&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Uninstall the Docker CE package:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get purge docker-ce
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Images, containers, volumes, or customized configuration files on your host are not automatically removed. To delete all images, containers, and volumes:&lt;/p&gt;

    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;rm &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /var/lib/docker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;23-other-installation-methods&quot;&gt;2.3. Other installation methods&lt;/h3&gt;
&lt;p&gt;You can also install Docker CE from &lt;em&gt;a package&lt;/em&gt; or &lt;em&gt;using the convenience script&lt;/em&gt;. Again, for details check &lt;a href=&quot;https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-repository&quot;&gt;here&lt;/a&gt;!&lt;/p&gt;

&lt;h2 id=&quot;3-docker-basics&quot;&gt;3. Docker basics&lt;/h2&gt;
&lt;p&gt;Docker official site provides a very nice set of &lt;a href=&quot;https://docs.docker.com/get-started/&quot;&gt;Tutorials&lt;/a&gt;. It’s highly recommended to go through the first couple of sections of the tutorial. Here I’d like to keep a record of the very basic steps and commands to get started with Docker.&lt;/p&gt;

&lt;p&gt;The best and complete way to learn Docker is to go through this &lt;a href=&quot;https://docs.docker.com/get-started/&quot;&gt;Get Started from Docker’s Official&lt;/a&gt;. Here I just take a record of the core concepts and commands for myself.&lt;/p&gt;

&lt;h3 id=&quot;31-docker-concepts&quot;&gt;3.1. Docker Concepts&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Image:&lt;/p&gt;

    &lt;p&gt;An &lt;strong&gt;image&lt;/strong&gt; is an executable package that includes everything needed to run an application–the code, a runtime, libraries, environment variables, and configuration files.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Container:&lt;/p&gt;

    &lt;p&gt;A &lt;strong&gt;container&lt;/strong&gt; is a runtime instance of an image–what the image becomes in memory when executed (that is, an image with state, or a user process). You can see a list of your running containers with the command, &lt;code class=&quot;highlighter-rouge&quot;&gt;docker ps&lt;/code&gt;, just as you would in Linux.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Container vs. Virtual Machines:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A &lt;strong&gt;container&lt;/strong&gt; runs natively on Linux and shares the kernel of the host machine with other containers. It runs a discrete process, taking no more memory than any other executable, making it lightweight.&lt;/p&gt;

&lt;p&gt;By contrast, a &lt;strong&gt;virtual machine (VM)&lt;/strong&gt; runs a full-blown “guest” operating system with virtual access to host resources through a hypervisor. In general, VMs provide an environment with more resources than most applications need.&lt;/p&gt;

&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;
    &lt;img src=&quot;/public/img/20181128-docker-container.png&quot; /&gt;
    &lt;/td&gt;

    &lt;td&gt;
    &lt;img src=&quot;/public/img/20181128-docker-VM.png&quot; /&gt;
	&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;h3 id=&quot;32-cheat-sheet-1---check-info&quot;&gt;3.2. &lt;strong&gt;Cheat sheet 1 - Check info&lt;/strong&gt;&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;## List Docker CLI commands&lt;/span&gt;
docker
docker container &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;## Display Docker version and info&lt;/span&gt;
docker &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt;
docker version
docker info

&lt;span class=&quot;c&quot;&gt;## Execute Docker image&lt;/span&gt;
docker run hello-world

&lt;span class=&quot;c&quot;&gt;## List Docker images&lt;/span&gt;
docker image &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;## List Docker containers (running, all, all in quiet mode)&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--all&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-aq&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;33-cheat-sheet-2---check-info&quot;&gt;3.3. &lt;strong&gt;Cheat sheet 2 - Check info&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;After &lt;code class=&quot;highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;app.py&lt;/code&gt; (optionally &lt;code class=&quot;highlighter-rouge&quot;&gt;requirements&lt;/code&gt;) are ready:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
docker build &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; friendlyhello &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# Create image using this directory's Dockerfile&lt;/span&gt;
docker run &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4000:80 friendlyhello  &lt;span class=&quot;c&quot;&gt;# Run &quot;friendlyname&quot; mapping port 4000 to 80&lt;/span&gt;
docker run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4000:80 friendlyhello         &lt;span class=&quot;c&quot;&gt;# Same thing, but in detached mode&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;                                &lt;span class=&quot;c&quot;&gt;# List all running containers&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;             &lt;span class=&quot;c&quot;&gt;# List all containers, even those not running&lt;/span&gt;
docker container stop &amp;lt;&lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;           &lt;span class=&quot;c&quot;&gt;# Gracefully stop the specified container&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; &amp;lt;&lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;         &lt;span class=&quot;c&quot;&gt;# Force shutdown of the specified container&lt;/span&gt;
docker container rm &amp;lt;&lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&quot;c&quot;&gt;# Remove specified container from this machine&lt;/span&gt;
docker container rm &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;c&quot;&gt;# Remove all containers&lt;/span&gt;
docker image &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;                             &lt;span class=&quot;c&quot;&gt;# List all images on this machine&lt;/span&gt;
docker image rm &amp;lt;image id&amp;gt;            &lt;span class=&quot;c&quot;&gt;# Remove specified image from this machine&lt;/span&gt;
docker image rm &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;docker image &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# Remove all images from this machine&lt;/span&gt;
docker login             &lt;span class=&quot;c&quot;&gt;# Log in this CLI session using your Docker credentials&lt;/span&gt;
docker tag &amp;lt;image&amp;gt; username/repository:tag  &lt;span class=&quot;c&quot;&gt;# Tag &amp;lt;image&amp;gt; for upload to registry&lt;/span&gt;
docker push username/repository:tag            &lt;span class=&quot;c&quot;&gt;# Upload tagged image to registry&lt;/span&gt;
docker run username/repository:tag                   &lt;span class=&quot;c&quot;&gt;# Run image from a registry&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3 id=&quot;33-cheat-sheet-3---services&quot;&gt;3.3. &lt;strong&gt;Cheat sheet 3 - Services&lt;/strong&gt;&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
docker stack &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;                                            &lt;span class=&quot;c&quot;&gt;# List stacks or apps&lt;/span&gt;
docker stack deploy &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &amp;lt;composefile&amp;gt; &amp;lt;appname&amp;gt;  &lt;span class=&quot;c&quot;&gt;# Run the specified Compose file&lt;/span&gt;
docker service &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;                 &lt;span class=&quot;c&quot;&gt;# List running services associated with an app&lt;/span&gt;
docker service ps &amp;lt;service&amp;gt;                  &lt;span class=&quot;c&quot;&gt;# List tasks associated with an app&lt;/span&gt;
docker inspect &amp;lt;task or container&amp;gt;                   &lt;span class=&quot;c&quot;&gt;# Inspect task or container&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt;                                      &lt;span class=&quot;c&quot;&gt;# List container IDs&lt;/span&gt;
docker stack rm &amp;lt;appname&amp;gt;                             &lt;span class=&quot;c&quot;&gt;# Tear down an application&lt;/span&gt;
docker swarm leave &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;      &lt;span class=&quot;c&quot;&gt;# Take down a single node swarm from the manager&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Operating System&quot;]" /><category term="docker" /><summary type="html">The famous “Docker” is a tool that can package an application and tis dependencies in a virtual container that can run on any Linux server. After getting my keras model, it’s a good chance to try docker to deploy a deep learning model as a API service. In this article, I’d like to write down all the important procedures and details about how to make this service work with docker.”</summary></entry><entry><title type="html">MIT 6.006 Algorithms Lecture 1 Notes</title><link href="http://localhost:4000/2018/11/01/MIT-6006-Lecture1" rel="alternate" type="text/html" title="MIT 6.006 Algorithms Lecture 1 Notes" /><published>2018-11-01T12:00:00+08:00</published><updated>2018-11-01T12:00:00+08:00</updated><id>http://localhost:4000/2018/11/01/MIT-6006-Lecture1</id><content type="html" xml:base="http://localhost:4000/2018/11/01/MIT-6006-Lecture1">&lt;blockquote&gt;
  &lt;p&gt;The starting note of the MIT 6.006 Algorithm course.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;course-overview&quot;&gt;Course Overview&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Efficient procedures for solving problems on large inputs.&lt;/li&gt;
  &lt;li&gt;Scalability&lt;/li&gt;
  &lt;li&gt;Classic data structures and elementary algorithms (CLRS text) -&amp;gt; 6.046 for more design of algorithms.&lt;/li&gt;
  &lt;li&gt;Real implementations in Python&lt;/li&gt;
  &lt;li&gt;Fun problems sets!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;content---8-modules&quot;&gt;Content - 8 modules&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;Algorithmic Thinking: Peak Finding&lt;/li&gt;
  &lt;li&gt;Sorting &amp;amp; Trees: Event simulation -&amp;gt; Event Simulation (Problem set 2)&lt;/li&gt;
  &lt;li&gt;Hasing: Genome Comparisons&lt;/li&gt;
  &lt;li&gt;Numerics: RSA Encryption&lt;/li&gt;
  &lt;li&gt;Graphs: Rubik’s Cube&lt;/li&gt;
  &lt;li&gt;Shortest Paths: Caltech -&amp;gt; MIT&lt;/li&gt;
  &lt;li&gt;Dynamic Programming: Image Compression&lt;/li&gt;
  &lt;li&gt;Advanced Topics&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;peak-finding&quot;&gt;Peak finding&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;1 D&lt;/li&gt;
  &lt;li&gt;2 D&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Algorithms&quot;]" /><category term="algorithm" /><category term="leture notes" /><summary type="html">The starting note of the MIT 6.006 Algorithm course.</summary></entry><entry><title type="html">Experiencing google cloud</title><link href="http://localhost:4000/2018/10/09/google-cloud" rel="alternate" type="text/html" title="Experiencing google cloud" /><published>2018-10-09T09:00:00+08:00</published><updated>2018-10-09T09:00:00+08:00</updated><id>http://localhost:4000/2018/10/09/google-cloud</id><content type="html" xml:base="http://localhost:4000/2018/10/09/google-cloud">&lt;blockquote&gt;
  &lt;p&gt;After experiencing google cloud for couple of week, I’d like to write something down here. On the one hand, there’re lots of tips, necessary knowledge and pitfalls to remember and check. One the other hand, just cannot resist to complain about this giant and complicated service system.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;why-google-cloud&quot;&gt;Why Google Cloud&lt;/h2&gt;
&lt;p&gt;So where shall we start? OK, first why Google Cloud? The reason for me is that it’s actually free to use. Well although it’s not literally free. As long as you apply an “free trial” account and enter your credit card info (they won’t automatically charge you, for sure), they will grant you $300 credit within one year to use for free completely. I have to say the google is really generous in this case.&lt;/p&gt;

&lt;p&gt;This screen shot below is my current balance as I’ve already used the google cloud for training with or without GPUs for about 2 weeks. $300 is worth several month decent using.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/public/img/20181009-01.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;bunch-of-services---in-a-nut-shell&quot;&gt;Bunch of services - in a nut shell&lt;/h2&gt;
&lt;p&gt;Google cloud provides a huge set of services. If you have no experience of using cloud service, it’s pretty hard to get started becuase you’d be dazzled by the the countless stuff.&lt;/p&gt;

&lt;p&gt;To get started, especially for those who want to leverage google cloud as a tool for deep learning, I’d like to list the frequently used services.&lt;/p&gt;

&lt;h3 id=&quot;1-cloud-computing&quot;&gt;1. Cloud computing&lt;/h3&gt;
&lt;p&gt;Cloud computing is most frequently used service in my usage. As introduced by google itself, it provides &lt;em&gt;“Scalable, High-Perfoermance Virtual Machines”&lt;/em&gt;.
To make it clear in a few words, this computing engine provides &lt;strong&gt;computing resource&lt;/strong&gt; such as CPU/GPU, memories, with a separate  pricing rule (only based on how many CPUs, GPUs, RAMs you are using) excluding the storage info.&lt;/p&gt;

&lt;p&gt;When your VM is started, cloud computing service starts charging your credit. But as long as you shut it down. The charge from compute engine is stopped.&lt;/p&gt;

&lt;h3 id=&quot;2-storage&quot;&gt;2. Storage&lt;/h3&gt;
&lt;p&gt;The compute engine cannot run without a disk, which is related to the storage service. For instance, when you create a VM, you always also apply a disk of 10G or 30G space for the computing engine you chosed. (But remember, the fee for storage is charged separately. ) Basically, there are two different kind of  storage service that is most frequently use.&lt;/p&gt;

&lt;h4 id=&quot;21-persistent-disk&quot;&gt;2.1 Persistent Disk&lt;/h4&gt;
&lt;p&gt;In short, the persistent disk is block storage for virtual machine instances and storage to be mounted to VMs.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;It’s just like normal disks.&lt;/li&gt;
  &lt;li&gt;You have to let your VM running before you can access this kind of storage.&lt;/li&gt;
  &lt;li&gt;It’s easy to manipulate the files in the disks.&lt;/li&gt;
  &lt;li&gt;The persistent disk charges with it’s own rates.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;22-cloud-storage&quot;&gt;2.2 Cloud Storage&lt;/h4&gt;
&lt;p&gt;It’s object storage, in the actual use, each cloud storage block is  called a ‘bucket’.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;You can access this kind of storage by using their &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil&lt;/code&gt; tool from cloud shell or even from your computer using google cloud sdk.&lt;/li&gt;
  &lt;li&gt;You do not need to start any VM to access your data stored in the ‘buckets’.&lt;/li&gt;
  &lt;li&gt;It’s a great tool for uploading and downloading files from google cloud. Multi-thread &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil -m scp&lt;/code&gt; makes it much faster than normal &lt;code class=&quot;highlighter-rouge&quot;&gt;scp&lt;/code&gt; in POSIX file system.&lt;/li&gt;
  &lt;li&gt;You have to use &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil&lt;/code&gt; to access and manipulate the data in the storage, which is a little bit awkward when you need to treate the files and folders in your ‘traditional’ mindset.&lt;/li&gt;
  &lt;li&gt;the cloud storage charges with its own rates, roughly based on the amount of storage and the inward/outward stream amout.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pricing&quot;&gt;Pricing&lt;/h2&gt;
&lt;p&gt;The story about pricing is trivial! This reminds me of the main reason why I usually prefer Apple’s products rather than google’s.&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;IT’S SHOULD BE SIMPLE!!!
When I was checking the pricing rate of these google cloud services, it’s like, suppose I want to buy a new iPhone and go to their store and ask: “I’d like to buy an iPhone, which one should I choose?” Think that if the guy tells me “well that depends on what kind of processor, storage, RAMs, camera you want. Here is the pricing list and help yourself …” 
&lt;strong&gt;See? this would drive me crazy. And this is how you feel when you are checking google cloud pricing&lt;/strong&gt;. 
The real way apple store would respond is: “Here are three new iPhones with basic price of $749, $999 and $1099, you can add more storage with extra price …”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;My dear google, why don’t you make the pricing a little bit straight forward? Wouldn’t a rough approximation for every service rate in one page as a pricing overview be much better???&lt;/p&gt;

&lt;p&gt;A little digressed from the subject. Here I give a rough pricing list for most the services mentioned above.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;Service&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;Rate per Hour&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;Rate per Day&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;Rate per Month&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;CPU VM&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;~$1.00&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;GPU VM &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;~$1.00&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Persistent Disk&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;~$2.00 per 100G&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;Cloud Storage&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;-&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;~$2.00 per 100G&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;I hope in this way you can have a general idea of the pricing of these google cloud services.&lt;/p&gt;

&lt;h2 id=&quot;commands&quot;&gt;Commands&lt;/h2&gt;
&lt;p&gt;In the following I’ll continue to list some commonly use commands with google cloud’s daily-based usage.&lt;/p&gt;

&lt;h3 id=&quot;compute-engine-basic&quot;&gt;Compute Engine Basic&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Set/Unset zone:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Set zone&lt;/span&gt;
gcloud config &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;compute/zone &amp;lt;zone-name&amp;gt;
&lt;span class=&quot;c&quot;&gt;# Unset zone&lt;/span&gt;
gcloud config &lt;span class=&quot;nb&quot;&gt;unset &lt;/span&gt;compute/zone &amp;lt;zone-name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;List all the VM instances:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute instances list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Start a VM instance:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute instances start &amp;lt;instance-name&amp;gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--zone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;zone-name&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Terminate a VM instance:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute instances stop &amp;lt;instance-name&amp;gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--zone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;zone-name&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;SSH login to VM instance:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute ssh &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;user-name&amp;gt;@]&amp;lt;instance-name&amp;gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--zone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;zone-name&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Transfer files from/to the VM instance:
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# From local to VM instance&lt;/span&gt;
gcloud compute scp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--recurse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &amp;lt;file-dir&amp;gt; &amp;lt;user-name&amp;gt;@&amp;lt;instance-name&amp;gt;:&amp;lt;dest-dir&amp;gt;
&lt;span class=&quot;c&quot;&gt;# From VM instance to local&lt;/span&gt;
gcloud compute scp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--recurse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;user-name&amp;gt;@]&amp;lt;instance-name&amp;gt;:&amp;lt;file-dir&amp;gt; &amp;lt;dest-dir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;mountunmount-persistent-disk&quot;&gt;Mount/Unmount Persistent Disk&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/compute/docs/disks/add-persistent-disk&quot;&gt;Adding or Resizing Persistent Disks&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Create a persistent disk:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute disks create &amp;lt;disk-name&amp;gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt; &amp;lt;disk-size&amp;gt; &lt;span class=&quot;nt&quot;&gt;--type&lt;/span&gt; &amp;lt;disk-type&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;where:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;disk-name&gt; is the name of the new disk.
&lt;/disk-name&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;disk-size&gt; is the size of the new disk in GB.
&lt;/disk-size&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;disk-type&gt; is the type of persistent disk. Either `pd-standard` or `pd-ssd`.

&lt;/disk-type&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Attach a disk to any running or stopped instance
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcloud compute instances attach-disk &amp;lt;instance-name&amp;gt; &lt;span class=&quot;nt&quot;&gt;--disk&lt;/span&gt; &amp;lt;disk-name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;In an instance, list disks attached to the current instance:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;lsblk
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Format the disk: (usually, the &lt;code class=&quot;highlighter-rouge&quot;&gt;DEVICE_ID&lt;/code&gt; is &lt;code class=&quot;highlighter-rouge&quot;&gt;sdb&lt;/code&gt;)
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;mkfs.ext4 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lazy_itable_init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,lazy_journal_init&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0,discard /dev/&amp;lt;DEVICE_ID&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Mount the disk to the instance:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mount &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; discard, defaults /dev/&amp;lt;DEVICE_ID&amp;gt; &amp;lt;mnt_dir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;where&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;the &lt;code class=&quot;highlighter-rouge&quot;&gt;DEVICE_ID&lt;/code&gt; is often &lt;code class=&quot;highlighter-rouge&quot;&gt;sdb&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mnt_dir&lt;/code&gt; is the directory where you want the disk to be mounted, usually you create such folder before this &lt;code class=&quot;highlighter-rouge&quot;&gt;mount&lt;/code&gt; command.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Grant write access to the device for all users:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;chmod a+w &amp;lt;mnt_dir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Add the persistent disk to &lt;code class=&quot;highlighter-rouge&quot;&gt;etc/fstab&lt;/code&gt; file so t hat the device automatically mounts again when the instance restarts.&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;Create a backup of your current
        &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;cp /etc/fstab /etc/fstab.backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;Use the blkid command to find the UUID for the persistent disk. The system generates this UUID when you format the disk. Use UUIDs to mount persistent disks because UUIDs do not change when you move disks between systems.&lt;/li&gt;
      &lt;li&gt;Create a backup of your current &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/fstab&lt;/code&gt; file.
        &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;blkid /dev/[DEVICE_ID] /dev/[DEVICE_ID]: &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[UUID_VALUE]&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;p&gt;where:&lt;/p&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[DEVICE_ID]&lt;/code&gt; is the device ID of the persistent disk that you want to automatically mount. If you created a partition table on the disk, specify the partition that you want to mount.&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[UUID_VALUE]&lt;/code&gt; is the UUID of the persistent disk that you must include in the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/fstab&lt;/code&gt; file.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Open the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/fstab&lt;/code&gt; file in a text editor and create an entry that includes the UUID. For example:
        &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=[&lt;/span&gt;UUID_VALUE] /mnt/disks/[MNT_DIR] ext4 discard,defaults,[NOFAIL_OPTION] 0 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
        &lt;p&gt;where:&lt;/p&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[UUID_VALUE]&lt;/code&gt; is the UUID of the persistent disk that you must include in the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/fstab&lt;/code&gt; file.&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[MNT_DIR]&lt;/code&gt; is the directory where you mounted your persistent disk.&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;[NOFAIL_OPTION]&lt;/code&gt; is a variable that specifies what the operating system should do if it cannot mount the persistent disk at boot time. To allow the system to continue booting even when it cannot mount the persistent disk, specify this option. For most distributions, specify the nofail option. For Ubuntu 12.04 or Ubuntu 14.04, specify the nobootwait option.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cloud-storage-operation-tools&quot;&gt;Cloud Storage Operation Tools&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://cloud.google.com/compute/docs/disks/gcs-buckets&quot;&gt;Connecting to Cloud Storage buckets&lt;/a&gt;
&lt;a href=&quot;https://cloud.google.com/storage/docs/quickstart-gsutil#create&quot;&gt;Quickstart: Using the gsutil Tool&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Create a bucket by using &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil mb&lt;/code&gt; command:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gsutil mb &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; us-east1 gs://my-awesome-bucket/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;note that the bucket name should be globally-unique.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Copy local file to the bucket using &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil cp&lt;/code&gt; command:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gsutil &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; cp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &amp;lt;file-name&amp;gt; gs://my-awesome-bucket
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;&lt;strong&gt;Remember&lt;/strong&gt;: using &lt;code class=&quot;highlighter-rouge&quot;&gt;-m&lt;/code&gt; flag to activate multi-thread will increase the transfer speed dramatically.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Download file from bucket using &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil cp&lt;/code&gt; command:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gsutil &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; cp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; gs://my-awesome-bucket/&amp;lt;file-name&amp;gt; &amp;lt;local-dir&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Delete an object using &lt;code class=&quot;highlighter-rouge&quot;&gt;gsutil rm&lt;/code&gt;:
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Delete file&lt;/span&gt;
gsutil rm gs://my-awesome-bucket/&amp;lt;file-name&amp;gt;
&lt;span class=&quot;c&quot;&gt;# Delete folder&lt;/span&gt;
gsutil rm &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; gs://my-awesome-bucket/&amp;lt;folder-name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Remove the bucket
    &lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gsutil rm &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; gs://my-awesome-bucket
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Deep Learning&quot;]" /><category term="google cloud" /><category term="deep learning" /><summary type="html">After experiencing google cloud for couple of week, I’d like to write something down here. On the one hand, there’re lots of tips, necessary knowledge and pitfalls to remember and check. One the other hand, just cannot resist to complain about this giant and complicated service system.</summary></entry><entry><title type="html">Python None</title><link href="http://localhost:4000/2018/06/21/python-None" rel="alternate" type="text/html" title="Python None" /><published>2018-06-21T14:00:00+08:00</published><updated>2018-06-21T14:00:00+08:00</updated><id>http://localhost:4000/2018/06/21/python-None</id><content type="html" xml:base="http://localhost:4000/2018/06/21/python-None">&lt;blockquote&gt;
  &lt;p&gt;Python 中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;None&lt;/code&gt; 是什么？&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/baicaiye/article/details/72922197&quot;&gt;baicaiye专栏&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.python.org/3/c-api/none.html&quot;&gt;Python NoneType - python.org&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;None是一个特殊的常量。
None和False不同。
None不是0。
None不是空字符串。
None和任何其他的数据类型比较永远返回False。
None有自己的数据类型NoneType。
你可以将None复制给任何变量，但是你不能创建其他NoneType对象。&lt;/p&gt;

&lt;h2 id=&quot;the-none-object&quot;&gt;The None Object&lt;/h2&gt;

&lt;p&gt;Note that the PyTypeObject for None is not directly exposed in the Python/C API. Since None is a &lt;strong&gt;singleton&lt;/strong&gt;, testing for object identity (using == in C) is sufficient. There is no PyNone_Check() function for the same reason.&lt;/p&gt;

&lt;h3 id=&quot;pyobject-py_none&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;PyObject* Py_None&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;The Python None object, denoting lack of value. This object has no methods. It needs to be treated just like any other object with respect to reference counts.&lt;/p&gt;

&lt;h3 id=&quot;py_return_none&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Py_RETURN_NONE&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Properly handle returning Py_None from within a C function (that is, increment the reference count of None and return it.)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Python&quot;, &quot;Notes&quot;]" /><category term="python" /><summary type="html">Python 中的 None 是什么？</summary></entry><entry><title type="html">RNN LSTM - Notes</title><link href="http://localhost:4000/2018/06/12/RMM-LSTM-copy" rel="alternate" type="text/html" title="RNN LSTM - Notes" /><published>2018-06-12T14:00:00+08:00</published><updated>2018-06-12T14:00:00+08:00</updated><id>http://localhost:4000/2018/06/12/RMM-LSTM%20copy</id><content type="html" xml:base="http://localhost:4000/2018/06/12/RMM-LSTM-copy">&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;“Deep Learning”&lt;/em&gt; Reading note&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;10-sequence-modeling-recurrent-and-recursive-nets&quot;&gt;10. Sequence Modeling: Recurrent and Recursive nets&lt;/h3&gt;

&lt;h4 id=&quot;101-unfolding-computational-graphs&quot;&gt;10.1 Unfolding Computational Graphs&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;What is a Computational Graph?&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;A computational graph is a way to formalize the structure of a set of computations.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Considering a classical form of a dynamic system:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;s^{(t)} = f \left( s^{(t-1)} ; \theta \right), \tag{10.1}&lt;/script&gt;

&lt;p&gt;where $s$ is called the state of the system. And it is a recurrent.&lt;/p&gt;

&lt;p&gt;For a finite number of $\tau$ steps, we can unfold the equation. For example, when $\tau = 3$, we have&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\begin{eqnarray*}
s^{(3)} &amp;=&amp; f\left( s^{(2)}; \theta \right) \tag{10.2} \\
 &amp;=&amp; f\left(f\left( s^{(1)}; \theta \right);\theta\right) \tag{10.3}
 \end{eqnarray*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Another example, considering a dynamic system driven by an external signal $x^{(t)}$,
&lt;script type=&quot;math/tex&quot;&gt;s^{(t)} = f\left( s^{(t-1)}, x^{(t)};\theta \right) \tag{10.4}&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;To indicate the state  is the hidden units of the network, we rewrite equation 10.4 using $h$ to represent the state,
&lt;script type=&quot;math/tex&quot;&gt;h^{(t)} = f\left(h^{(t-1)}, x^{(t)}; \theta \right) \tag{10.5}&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;We can represent the unfolded recurrence after $t$ steps with a function $g^{(t)}$:
&lt;script type=&quot;math/tex&quot;&gt;% &lt;![CDATA[
\begin{eqnarray*}
h^{(t)} &amp;=&amp; g^{(t)}\left(x^{(t)}, x^{(t-1)}, x^{(t-2)}, ..., x^{(2)}, x^{(1)}\right) \tag{10.6} \\
&amp;=&amp; f\left(h^{(t-1)}, x^{(t)};\theta\right). \tag{10.7}
\end{eqnarray*} %]]&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;The function $ g^{(t)} $ takes the whole past sequence $\left(x^{(t)}, x^{(t-1)}, x^{(t-2)}, …, x^{(2)}, x^{(1)} \right)$ as input and produces the current state. But the unfolded recurrent structure allows us to factorize the function into repeated application of a function $f$, the unfolding process introduces two major advantages:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;The learned model always has the same input size, which specified in terms of transition from one state to another.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;It is possible to use the &lt;em&gt;same&lt;/em&gt; transition function $f$ with the same parameters at every time step.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;102-recurrent-neural-networks-循环神经网络&quot;&gt;10.2 Recurrent Neural Networks （循环神经网络）&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;Based on the basic idea of parameter-sharing, we can build a variety of neural networks. 3 typical designs are presented in the book:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;RNN produce an output at each time step, and have connections between hidden unit. (Page 368, fig. 10.3)&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;RNN produce an output at each time step and have connections from &lt;em&gt;the output at one time step&lt;/em&gt; to &lt;em&gt;the hidden units at the next time step&lt;/em&gt;. (Page 370, fig. 10.4)&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ol&gt;
      &lt;li&gt;RNN connections between hidden units, that read an entire sequence and then produce a single output (page. 371, fig. 10.5)&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;The RNN of figure 10.3 (p.368) and equation 10.8 (p.369) is universal in the sense that (从…意义上来说）&lt;em&gt;any&lt;/em&gt;function computable by a Turing machine can be computed by such a recurrent network of a finite size.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In the book, case 1 is chosen as a throughout example. 
Figure 10.3 (p.369) or say equation 10.8 (p. 370) defines forward propagation in this model.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[
\DeclareMathOperator{\softmax}{softmax}
\begin{eqnarray*}
\pmb{a}^{(t)} &amp;=&amp; \pmb{b} + \pmb{W}\pmb{h}^{(t-1)} + \pmb{U}\pmb{x}, \tag{10.8} \\
\pmb{h}^{(t)} &amp;=&amp; \tanh\left(\pmb{a}^{(t)}\right), \tag{10.9} \\
\pmb{o}^{(t)} &amp;=&amp; \pmb{c} + \pmb{V}\pmb{h}^{(t)}, \tag{10.10} \\
\hat{\pmb{y}} ^{(t)} &amp;=&amp; \softmax \left(\pmb{o}^{(t)} \right), \tag{10.11}
\end{eqnarray*} %]]&gt;&lt;/script&gt;

&lt;p&gt;Parameters: bias vecters $\pmb{b}$, $\pmb{c}$, weight matrices $\pmb{U}$, $\pmb{V}$ and $\pmb{W}$.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$\pmb W$ is the hidden-to-hidden recurrent weight matrix&lt;/li&gt;
  &lt;li&gt;$\pmb V$ is the hidden-to-output weight matrix&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;$\pmb U$ is the input-to-hidden weight matrix&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;This is an example of a recurrent network that maps an input sequence $\pmb{x}^{(t)}$ to an output sequence $\pmb{y}^{(t)}$ of the same length $t$ in a range of $(1, \tau)$.&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;The Loss Function:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;</content><author><name></name></author><category term="[&quot;Artifitial Intelligence&quot;, &quot;Notes&quot;]" /><category term="rnn" /><category term="lstm" /><category term="machine learning" /><category term="deep learning" /><summary type="html">“Deep Learning” Reading note</summary></entry><entry><title type="html">Welcome to Jekyll!</title><link href="http://localhost:4000/2017/03/23/welcome-to-jekyll" rel="alternate" type="text/html" title="Welcome to Jekyll!" /><published>2017-03-23T01:30:13+08:00</published><updated>2017-03-23T01:30:13+08:00</updated><id>http://localhost:4000/2017/03/23/welcome-to-jekyll</id><content type="html" xml:base="http://localhost:4000/2017/03/23/welcome-to-jekyll">&lt;blockquote&gt;
  &lt;p&gt;You’ll find this post in your &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt;, which launches a web server and auto-regenerates your site when a file is updated.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;p&gt;To add new posts, simply add a file in the &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory that follows the convention &lt;code class=&quot;highlighter-rouge&quot;&gt;YYYY-MM-DD-name-of-post.ext&lt;/code&gt; and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works.&lt;/p&gt;

&lt;p&gt;Jekyll also offers powerful support for code snippets:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;print_hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hi, &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;print_hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Tom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; prints 'Hi, Tom' to STDOUT.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Check out the &lt;a href=&quot;https://jekyllrb.com/docs/home&quot;&gt;Jekyll docs&lt;/a&gt; for more info on how to get the most out of Jekyll. File all bugs/feature requests at &lt;a href=&quot;https://github.com/jekyll/jekyll&quot;&gt;Jekyll’s GitHub repo&lt;/a&gt;. If you have questions, you can ask them on &lt;a href=&quot;https://talk.jekyllrb.com/&quot;&gt;Jekyll Talk&lt;/a&gt;.&lt;/p&gt;</content><author><name></name></author><category term="jekyll" /><summary type="html">You’ll find this post in your _posts directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run jekyll serve, which launches a web server and auto-regenerates your site when a file is updated.</summary></entry><entry><title type="html">Knowledge of Leukemia</title><link href="http://localhost:4000/2016/12/18/leukemia" rel="alternate" type="text/html" title="Knowledge of Leukemia" /><published>2016-12-18T09:37:00+08:00</published><updated>2016-12-18T09:37:00+08:00</updated><id>http://localhost:4000/2016/12/18/leukemia</id><content type="html" xml:base="http://localhost:4000/2016/12/18/leukemia">&lt;blockquote&gt;
  &lt;p&gt;在这里汇总一下关于这个病的一些知识和其他信息。要战胜敌人就得充分了解敌人。盼望南哥战胜它，早日康复！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;resources&quot;&gt;Resources:&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.bloodjournal.org/content/116/18/3409?sso-checked=true&quot;&gt;How I treat Philadelphia chromosome–positive acute lymphoblastic leukemia&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Important Excerpt from an In-Depth Report on ALL&lt;sup id=&quot;fnref:maryland-report&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;
This is an in-depth report on the causes, diagnosis, treatment, and prevention of leukemia:&lt;/p&gt;
  &lt;blockquote&gt;
    &lt;p&gt;&lt;a href=&quot;http://umm.edu/health/medical/reports/articles/acute-lymphocytic-leukemia&quot;&gt;&lt;strong&gt;Acute Lymphocytic Leukemia - An in-depth Report&lt;/strong&gt; - University of Maryland Medical Center&lt;/a&gt;&lt;/p&gt;
  &lt;/blockquote&gt;

  &lt;p&gt;There are some key information and factors in the report and are listed below:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;i-acute-lymphocytic-leukemia&quot;&gt;I. Acute Lymphocytic Leukemia&lt;sup id=&quot;fnref:maryland-report:1&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;p&gt;Acute lymphocytic leukemia (ALL) is also known as acute lymphoid leukemia or acute lymphoblastic leukemia. The majority of childhood leukemias are of the ALL type.&lt;/p&gt;

&lt;p&gt;Lymphocytes are the body’s primary immune cells. Among other vital functions, lymphocytes produce antibodies, factors that can target and attack specific foreign substances (antigens) and fight infections.&lt;/p&gt;

&lt;p&gt;Lymphocytes develop in the thymus gland or bone marrow and are therefore categorized as either B cells (bone marrow-derived cells) or T cells (thymus gland-derived cells).  ALL can arise from either T-cell or &lt;strong&gt;B-cell&lt;/strong&gt; lymphocytes. Most cases of ALL involve &lt;strong&gt;B cells&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;ii-causes&quot;&gt;II. Causes&lt;sup id=&quot;fnref:maryland-report:2&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;p&gt;Doctors do not know exactly what causes acute lymphocytic leukemia (ALL). It is likely that ALL develops from a combination of genetic, biologic, and environmental factors.&lt;/p&gt;

&lt;h3 id=&quot;genetic-translocations&quot;&gt;Genetic Translocations&lt;/h3&gt;

&lt;p&gt;Up to 65% of leukemias contain genetic rearrangements, called translocations, in which some of the genetic material (genes) on a chromosome may be shuffled or swapped between a pair of chromosomes.&lt;/p&gt;

&lt;p&gt;The most common genetic translocation in ALL is the Philadelphia (Ph) chromosome where DNA is swapped between chromosomes 9 and 22 [t(9:22)]. It occurs in about 20 - 30% of adults and 3 - 5% of children with ALL.&lt;/p&gt;

&lt;h2 id=&quot;iii-risk-factors&quot;&gt;III. Risk Factors&lt;sup id=&quot;fnref:maryland-report:3&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;h3 id=&quot;hereditary-disorders&quot;&gt;Hereditary Disorders&lt;/h3&gt;
&lt;p&gt;ALL does not appear to run in families. Still, certain genetic disorders may increase risk. For example, children with Down syndrome have a 20-times greater risk of developing ALL than the general population. Other rare genetic disorders associated with increased risk include Klinefelter syndrome, Bloom syndrome, Fanconi anemia, ataxia-telangiectasia, neurofibromatosis, Shwachman syndrome, IgA deficiency, and congenital X-linked agammaglobulinemia.&lt;/p&gt;

&lt;h3 id=&quot;radiation-and-chemical-exposure&quot;&gt;Radiation and Chemical Exposure&lt;/h3&gt;

&lt;p&gt;Previous cancer treatment with high doses of radiation or chemotherapy can increase the risk for developing ALL. Prenatal exposure to x-rays may also increase risk in children. Lower levels of radiation (living near power lines, video screen emissions, small appliances, cell phones) are unlikely to pose any cancer risk.&lt;/p&gt;

&lt;h2 id=&quot;iv-symptoms&quot;&gt;IV. Symptoms&lt;sup id=&quot;fnref:maryland-report:4&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;p&gt;The symptoms of ALL may be difficult to recognize. ALL usually begins abruptly and intensely, but in some cases symptoms may develop slowly. They may be present one day, and absent the next, particularly in children. Symptoms develop when:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;There are not enough healthy mature white blood cells (leukocytes) to mount a defense against infection.&lt;/li&gt;
  &lt;li&gt;There are not enough healthy blood-clotting cells (platelets) to prevent bleeding.&lt;/li&gt;
  &lt;li&gt;The depleted oxygen-bearing red blood cells can’t provide enough oxygen to organs.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Symptoms include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fatigue&lt;/li&gt;
  &lt;li&gt;Paleness – patients may have poor coloring from anemia caused by insufficient red blood cells&lt;/li&gt;
  &lt;li&gt;Recurrent minor infections&lt;/li&gt;
  &lt;li&gt;Fever without known cause&lt;/li&gt;
  &lt;li&gt;Bone pain&lt;/li&gt;
  &lt;li&gt;Abdominal swelling&lt;/li&gt;
  &lt;li&gt;Bruising – may result from only slight injury&lt;/li&gt;
  &lt;li&gt;Poor healing of minor cuts&lt;/li&gt;
  &lt;li&gt;Uncontrolled bleeding – bleeding events increase as the bone marrow fails to produce enough platelets to make a normal blood clot, a condition called thrombocytopenia.&lt;/li&gt;
  &lt;li&gt;Small, red spots on the skin (petechiae)&lt;/li&gt;
  &lt;li&gt;Vision changes (rare)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;v-prognosis&quot;&gt;V. Prognosis&lt;sup id=&quot;fnref:maryland-report:5&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;
&lt;p&gt;ALL is one of the most curable cancers and survival rates are now at an all-time high.&lt;/p&gt;

&lt;p&gt;According to the American Cancer Society, certain factors can help determine prognosis:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Age. Younger patients (especially those younger than age 50) have a better prognosis than older patients.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Initial white blood cell (WBC) count. People diagnosed with a WBC count below 50,000 tend to do better than people with higher WBC counts.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Response to chemotherapy. Patients who achieve complete remission (absence of active cancer) within 4 - 5 weeks of starting treatment tend to have a better prognosis than those who take longer.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vi-treatment&quot;&gt;VI. Treatment&lt;sup id=&quot;fnref:maryland-report:6&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;h3 id=&quot;1-treatment-phases&quot;&gt;1. Treatment Phases&lt;/h3&gt;

&lt;p&gt;There are typically &lt;strong&gt;three treatment stages&lt;/strong&gt; for the average-risk patient with ALL:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Induction&lt;/strong&gt; therapy is given in order to achieve a first remission (the absence of active cancer)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Consolidation&lt;/strong&gt; (intensification) therapy is given to prevent relapse after remission has been achieved&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Maintenance&lt;/strong&gt; treatment is lower intensity therapy given for several years to prevent relapse after remission&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Because leukemia can also spread to the brain and spinal cord, where chemotherapy that is given intravenously or orally does not penetrate very well, most patients also need radiation to the brain and spinal cord, or chemotherapy that is injected into the layers around them. This is called central nervous system prophylaxis (preventive treatment) and is given during all treatment phases to prevent the cancer from spreading to the brain and spinal cord.&lt;/p&gt;

&lt;h3 id=&quot;2-specific-treatments-used-in-all&quot;&gt;2. Specific Treatments Used in ALL&lt;/h3&gt;

&lt;p&gt;The following are specific treatments used for ALL:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Chemotherapy is the primary treatment&lt;/strong&gt; for each stage. Newer drugs known as biological therapies are also being used.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Radiation to the brain and spinal cord is also administered in some cases.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A &lt;strong&gt;bone marrow transplant&lt;/strong&gt; may be recommended for some adult patients after treatment when there is no active cancer (remission) or for adults and children if the cancer has returned after treatment (relapsed).&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;3-drugs-used-for-induction-chemotherapy&quot;&gt;3. Drugs Used for Induction Chemotherapy&lt;/h3&gt;
&lt;p&gt;Both children and adults typically start with a 3-drug regimen. Imatinib (Gleevec) or dasatinib (Sprycel) may be added for patients with Philadelphia chromosome-positive ALL.&lt;/p&gt;

&lt;p&gt;For &lt;strong&gt;adults&lt;/strong&gt;, the standard drugs are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Vincristine&lt;/li&gt;
  &lt;li&gt;Prednisone&lt;/li&gt;
  &lt;li&gt;Anthracycline drug, such as such as doxorubicin, daunorubicin, or epirubicin. Some adult chemotherapy regimens also add on an asparaginase drug or cyclophosphamide (Cytoxan).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;4-preventing-central-nervous-system-disease-cns-prophylaxis&quot;&gt;4. Preventing Central Nervous System Disease (CNS Prophylaxis)&lt;/h3&gt;

&lt;p&gt;Adult CNS prophylaxis is performed in one of three ways:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Cranial radiation plus intrathecal chemotherapy with methotrexate&lt;/li&gt;
  &lt;li&gt;High-dose systemic infusion of methotrexate plus intrathecal methotrexate without cranial radiation&lt;/li&gt;
  &lt;li&gt;Intrathecal methotrexate chemotherapy alone&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;5-evidence-of-remission-after-induction-treatment&quot;&gt;5. Evidence of Remission after Induction Treatment&lt;/h3&gt;

&lt;p&gt;Survival in acute leukemia depends on complete remission (no signs of active cancer). Although not always clear-cut, remission is indicated by the following:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;All signs and symptoms of leukemia disappear.&lt;/li&gt;
  &lt;li&gt;There are no abnormal cells in the blood, bone marrow, and cerebrospinal fluid.&lt;/li&gt;
  &lt;li&gt;The percentage of blast cells in the bone marrow is less than 5%.&lt;/li&gt;
  &lt;li&gt;Blood platelet count returns to normal.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Induction can produce extremely rapid results. Nearly all children with ALL achieve remission after a month of induction treatment. The shorter the time to remission the better the outlook:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A complete remission usually occurs within the first 4 weeks. Patients who show low disease levels within 7 - 14 days have an excellent outlook, particularly if they have favorable genetic factors, and may need less-intensive treatments afterward.&lt;/li&gt;
  &lt;li&gt;Patients with high disease levels at 14 days or who require more than 4 weeks to achieve remission are at higher risk for relapse and most likely need more aggressive treatment.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;6-side-effects-and-complications&quot;&gt;6. Side Effects and Complications&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Common Side Effects&lt;/em&gt;. Typical side effects include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Nausea and vomiting. Drugs known as serotonin antagonists, such as ondansetron (Zofran) or granisteron (Kyril), can relieve these side effects.&lt;/li&gt;
  &lt;li&gt;Diarrhea&lt;/li&gt;
  &lt;li&gt;Hair loss&lt;/li&gt;
  &lt;li&gt;Mouth sores&lt;/li&gt;
  &lt;li&gt;Weight loss&lt;/li&gt;
  &lt;li&gt;Depression&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vii-transplantation&quot;&gt;VII. Transplantation&lt;/h2&gt;

&lt;h3 id=&quot;1-transplantation&quot;&gt;1. Transplantation&lt;/h3&gt;

&lt;p&gt;Stem cells that are made in the bone marrow are the early form of all blood cells in the body. They normally mature into red, white, or immune cells. To help the patient survive high dose chemotherapy needed to cure leukemia that has returned treatment, or not responded to treatment, a stem cell transplantation procedure may be used. Stem cell transplantation replaces blood stem cells that were lost during the initial chemotherapy treatment. The lost stem cells are replaced by transplanting them from a donor into the patient.&lt;/p&gt;

&lt;h3 id=&quot;2-the-blood-stem-cell-collection-procedure&quot;&gt;2. The Blood Stem Cell Collection Procedure&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Sources of Cells&lt;/em&gt;. Stem cells can be obtained either from the donor’s:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;(Bone marrow (bone marrow transplantation)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Blood (peripheral blood stem cell transplantation)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;3-the-transplant-procedure&quot;&gt;3. The Transplant Procedure&lt;/h3&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;The patient with ALL is given high-dose chemotherapy with or without radiation – a treatment known as conditioning. The point is to inactivate the immune system and to kill any remaining leukemia cells.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A few days after treatment, the patient is &lt;em&gt;rescued&lt;/em&gt; using the stored stem cells, which are administered through a vein. This may take several hours. Patients may experience fever, chills, hives, shortness of breath, or a fall in blood pressure during the procedure.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The patient is kept in a protected environment to minimize infection, and the patient usually needs blood cell replacement and nutritional support.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;4-side-effects-and-complications&quot;&gt;4. Side Effects and Complications&lt;/h3&gt;
&lt;p&gt;Stem-cell transplantation is a serious and complex procedure that can cause many short- and long-term side effects and complications.&lt;/p&gt;

&lt;p&gt;Early side effects of transplantation are similar to chemotherapy and include nausea, vomiting, fatigue, mouth sores, and loss of appetite.&lt;/p&gt;

&lt;p&gt;Bleeding because of reduced platelets is a high risk during the first four weeks and may require transfusions. Later side effects include fertility problems (if the ovaries are affected), thyroid gland problems (which can affect metabolism), lung damage (which can cause breathing problems) and bone damage.&lt;/p&gt;

&lt;h2 id=&quot;home-management-important&quot;&gt;Home Management (IMPORTANT)&lt;sup id=&quot;fnref:maryland-report:7&quot;&gt;&lt;a href=&quot;#fn:maryland-report&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;
&lt;p&gt;A parent should call the doctor if the child has any symptoms that are out of the ordinary, including (but not limited) to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Any fever of 101 °F or higher&lt;/li&gt;
  &lt;li&gt;Any signs of a flu or cold&lt;/li&gt;
  &lt;li&gt;Shortness of breath&lt;/li&gt;
  &lt;li&gt;Severe diarrhea&lt;/li&gt;
  &lt;li&gt;Blood in the urine or stools&lt;/li&gt;
  &lt;li&gt;Trouble urinating&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Tracking Neutrophils&lt;/strong&gt;. Family should track their patients absolute neutrophil count. This measurement for the &lt;strong&gt;amount of white blood cells&lt;/strong&gt; is an important gauge of his &lt;strong&gt;ability to fight infection&lt;/strong&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Counts over 1,000 usually provide sufficient protection so that children can engage in normal activities, including school and other functions where they are exposed to other children.&lt;/li&gt;
  &lt;li&gt;If the count is between 500 - 1,000, the child should avoid large groups.&lt;/li&gt;
  &lt;li&gt;If it falls between 200 - 500, the child should stay at home and should see only healthy visitors who have washed their hands vigorously.&lt;/li&gt;
  &lt;li&gt;Neutrophil counts below 200 indicate that the child is at high risk for infection and should have no visitors.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;preventing-infection&quot;&gt;Preventing Infection&lt;/h3&gt;

&lt;p&gt;It is &lt;strong&gt;very important&lt;/strong&gt; to take precautions to prevent infection following chemotherapy or transplantation. Guidelines for infection prevention and control include:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Discuss with the doctor what vaccinations are needed and when. Patient with ALL may need reimmunization. In general, it is best to have immunizations prior to chemotherapy and to avoid live virus vaccines during treatment,&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Avoid crowds, especially during cold and flu season.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Be diligent about hand washing and make sure that visitors wash their hands. Alcohol-based handrubs are best.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Avoid eating raw fruits and vegetables. Poultry, meat, fish, eggs and other foods should be cooked thoroughly. Do not eat foods purchased at salad bars or buffets. In the first few months after the transplant, be sure to eat protein-rich foods to help restore muscle mass and repair cell damage caused by chemotherapy and radiation.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Boil tap water before drinking it.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Dental hygiene is very important, including daily brushing and flossing. Use a soft toothbrush to prevent gum bleeding. Schedule regular visits with your dentist.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Do not sleep with pets. Avoid contact with pets’ excrement.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Avoid fresh flowers and plants as they may carry mold. Do not garden.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Swimming may increase exposure to infection. If you swim, do not submerge your face in water. Do not use hot tubs.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Report to the doctor any symptoms of fever, chills, cough, difficulty breathing, rash or changes in skin, and severe diarrhea or vomiting. Fever is one of the first signs of infection. Some of these symptoms can also indicate graft-versus-host disease.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Report to the ophthalmologist any signs of eye discharge or changes in vision. Patients who undergo radiation or who are on long-term steroid therapy have an increased risk for cataracts.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Some of the drugs used for leukemia cause extreme sun sensitivity. Sunburn can cause skin infection. Children should wear sunblock and sun-protective clothing when going outside.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;about-ph-positive-all&quot;&gt;About Ph-Positive ALL&lt;/h2&gt;

&lt;h3 id=&quot;what-is-ph-all-&quot;&gt;What is Ph+ ALL? &lt;sup id=&quot;fnref:ph-positive-CML&quot;&gt;&lt;a href=&quot;#fn:ph-positive-CML&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;“Ph” is an abbreviation for “Philadelphia chromosome,” the name given to the abnormal chromosome that can lead to the overproduction of white blood cells.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The plus sign (+) means that your laboratory tests show your bone marrow and white blood cells contain the abnormal Philadelphia chromosome.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;how-does-ph-happen&quot;&gt;How Does Ph+ Happen?&lt;sup id=&quot;fnref:ph-positive-CML:1&quot;&gt;&lt;a href=&quot;#fn:ph-positive-CML&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;The soft tissue inside our bones, called the bone marrow, produces a type of cell called a stem cell. As stem cells mature, they can turn into platelets, red blood cells, or white blood cells. Ph+ CML happens because of changes in the genetic material of these stem cells.&lt;/p&gt;

&lt;p&gt;Chromosomes are the parts of our cells that carry our DNA and genes—the things that give us our physical traits, such as blue eyes or brown hair, and that tell our body how to handle all the functions of life, including the process of making blood cells. Humans have 23 pairs of chromosomes. Ph+ CML happens when some genetic material from one chromosome (chromosome 9) switches position with some genetic material from another chromosome (chromosome 22).&lt;/p&gt;

&lt;p&gt;The new genetic material on chromosome 22 is called BCR-ABL and leads to abnormalities in your body’s process for making blood cells. When chromosome 22 has this abnormal BCR-ABL gene, scientists call it the Philadelphia chromosome. People with Ph+ CML have the BCR-ABL gene in their stem cells and white blood cells. The BCR-ABL gene produces a protein called Bcr-Abl. Scientists distinguish between the name of the gene and protein by how they are written.&lt;/p&gt;

&lt;p&gt;The Bcr-Abl protein causes your bone marrow to produce more and more white blood cells, and these white blood cells are often damaged. It acts like a switch that keeps your white blood cell production in the “on” position. Normally, your body would stop producing white blood cells that weren’t needed and damaged blood cells would die off, but the Bcr-Abl protein interferes with these processes. Instead, your bone marrow keeps making damaged white blood cells that, over time, crowd out healthy red blood cells and platelets.&lt;/p&gt;

&lt;p&gt;Scientists do not know exactly why the genetic material switches between the 2 chromosomes and continue to search for causes of Ph+ CML. Although Ph+ CML involves genetic material, be assured that it is not inherited. The abnormal gene is not passed down from parent to child.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.lls.org/leukemia/acute-lymphoblastic-leukemia/treatment/ph-positive-all-therapy&quot;&gt;Ph-Positive ALL Therapy&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;philadelphia-chromosome-&quot;&gt;Philadelphia Chromosome &lt;sup id=&quot;fnref:phil-chromo&quot;&gt;&lt;a href=&quot;#fn:phil-chromo&quot; class=&quot;footnote&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/h2&gt;
&lt;p&gt;The Philadelphia chromosome or Philadelphia translocation is a specific genetic abnormality in chromosome 22 of leukemia cancer cells (particularly chronic myelogenous leukemia (CML) cells). This chromosome is defective and unusually short because of reciprocal translocation of genetic material between chromosome 9 and chromosome 22, and contains a fusion gene called BCR-ABL1.&lt;/p&gt;

&lt;p&gt;(ABL represents “Abelson”, the name of a leukemia virus&lt;sup id=&quot;fnref:abelson&quot;&gt;&lt;a href=&quot;#fn:abelson&quot; class=&quot;footnote&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;.)&lt;/p&gt;

&lt;p&gt;Translocation results in an oncogenic BCR-ABL gene fusion that can be found on the shorter derivative 22 chromosome. This gene encodes for a Bcr-abl fusion protein. Depending on the precise location of fusion, the molecular weight of this protein can range from 185 to 210 kDa. Consequently, bcr-abl is referred to as p210 or p185.&lt;/p&gt;

&lt;p&gt;Three clinically important variants are the p190, p210, and p230 isoforms. p190 is generally associated with acute lymphoblastic leukemia (ALL), while &lt;strong&gt;p210&lt;/strong&gt; is generally associated with chronic myeloid leukemia but can also be associated with ALL.[6] p230 is usually associated with chronic myelogenous leukemia associated with neutrophilia and thrombocytosis.[6] Additionally, the p190 isoform can also be expressed as a splice variant of p210.[7]&lt;/p&gt;

&lt;center&gt;&lt;img src=&quot;/public/img/20161218-1-1.png&quot; width=&quot;400&quot; /&gt;&lt;/center&gt;

&lt;h3 id=&quot;nomenclature&quot;&gt;Nomenclature&lt;/h3&gt;
&lt;p&gt;The Philadelphia chromosome is designated Ph (or Ph’) chromosome and designates the shortened chromosome 22. It arises from the translocation, which is termed t(9;22)(q34.1;q11.2). This means there is a translocation between chromosome 9 and chromosome 22, with breaks happening in region (3), band (4), sub-band (1) of the long arm (q) of chromosome 9 and region (1), band (1), sub-band (2) of the long arm (q) of chromosome 22. Hence the chromosome breakpoints are written as (9q34.1) and (22q11.2), respectively, using ISCN standards. Notation omitting the sub-bands is also commonly seen: t(9;22)(q34;q11).&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
&lt;strong&gt;&lt;em&gt;KF&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:maryland-report&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://umm.edu/health/medical/reports/articles/acute-lymphocytic-leukemia&quot;&gt;&lt;strong&gt;Acute Lymphocytic Leukemia - An in-depth Report&lt;/strong&gt; - University of Maryland Medical Center&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:3&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:4&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:5&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:6&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;7&lt;/sup&gt;&lt;/a&gt; &lt;a href=&quot;#fnref:maryland-report:7&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;8&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:ph-positive-CML&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;http://www.gleevec.com/patient/ph-cml-treatment.jsp?usertrack.filter_applied=true&amp;amp;NovaId=4029462192126550515&quot;&gt;What is Ph+ CML? - GLEEVEC&lt;/a&gt; &lt;a href=&quot;#fnref:ph-positive-CML&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt; &lt;a href=&quot;#fnref:ph-positive-CML:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:phil-chromo&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Philadelphia_chromosome&quot;&gt;Philadelphia chromosome - Wikipedia&lt;/a&gt; &lt;a href=&quot;#fnref:phil-chromo&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:abelson&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Abelson_murine_leukemia_virus&quot;&gt;Abelson murine leukemia virus - Wikipedia&lt;/a&gt; &lt;a href=&quot;#fnref:abelson&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name></name></author><category term="[&quot;Life&quot;]" /><category term="leukemia" /><summary type="html">在这里汇总一下关于这个病的一些知识和其他信息。要战胜敌人就得充分了解敌人。盼望南哥战胜它，早日康复！</summary></entry></feed>